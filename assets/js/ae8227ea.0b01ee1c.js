"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5132],{8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var i=t(6540);const r={},c=i.createContext(r);function s(e){const n=i.useContext(c);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(c.Provider,{value:n},e.children)}},9572:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>u,frontMatter:()=>c,metadata:()=>a,toc:()=>l});var i=t(4848),r=t(8453);const c={slug:"get-kubeconfig",sidebar_position:1},s="get-kubeconfig",a={id:"credential-plugin/get-kubeconfig",title:"get-kubeconfig",description:"Obtain a kubeconfig file that uses ack-ram-tool as the credential plugin.",source:"@site/versioned_docs/version-v0.15.0/credential-plugin/get-kubeconfig.md",sourceDirName:"credential-plugin",slug:"/credential-plugin/get-kubeconfig",permalink:"/ack-ram-tool/v0.15.0/credential-plugin/get-kubeconfig",draft:!1,unlisted:!1,editUrl:"https://github.com/AliyunContainerService/ack-ram-tool/edit/master/website/versioned_docs/version-v0.15.0/credential-plugin/get-kubeconfig.md",tags:[],version:"v0.15.0",sidebarPosition:1,frontMatter:{slug:"get-kubeconfig",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"credential-plugin",permalink:"/ack-ram-tool/v0.15.0/category/credential-plugin"},next:{title:"get-kubeconfig\uff08\u4e2d\u6587\uff09",permalink:"/ack-ram-tool/v0.15.0/zh-CN/credential-plugin/kubeconfig"}},o={},l=[{value:"Usage",id:"usage",level:2},{value:"--mode ram-authenticator-token",id:"--mode-ram-authenticator-token",level:3},{value:"Flags",id:"flags",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"get-kubeconfig",children:"get-kubeconfig"}),"\n",(0,i.jsxs)(n.p,{children:["Obtain a kubeconfig file that uses ack-ram-tool as the ",(0,i.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/access-authn-authz/authentication/#client-go-credential-plugins",children:"credential plugin"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"It has the following features:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Automatically obtains a new certificate before the certificate expires."}),"\n",(0,i.jsx)(n.li,{children:"Supports using temporary certificate."}),"\n",(0,i.jsx)(n.li,{children:"Integrate ack-ram-authenticator."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:'$ ack-ram-tool credential-plugin get-kubeconfig --cluster-id c5e***\n\nkind: Config\napiVersion: v1\nclusters:\n    - name: kubernetes\n      cluster:\n        server: https://106.*.*.*:6443\n        certificate-authority-data: LS0tL***\ncontexts:\n    - name: 272***-c5e***\n      context:\n        cluster: kubernetes\n        user: "272***"\ncurrent-context: 272***-c5e***\nusers:\n    - name: "272***"\n      user:\n        exec:\n            command: ack-ram-tool\n            args:\n                - credential-plugin\n                - get-credential\n                - --cluster-id\n                - c5e***\n                - --api-version\n                - v1beta1\n                - --expiration\n                - 3h\n                - --log-level\n                - error\n            apiVersion: client.authentication.k8s.io/v1beta1\n            provideClusterInfo: false\n            interactiveMode: Never\npreferences: {}\n\n$ ack-ram-tool credential-plugin get-kubeconfig --cluster-id c5e*** > kubeconfig\n$ kubectl --kubeconfig kubeconfig get ns\nNAME                         STATUS   AGE\ndefault                      Active   6d3h\nkube-node-lease              Active   6d3h\nkube-public                  Active   6d3h\nkube-system                  Active   6d3h\n'})}),"\n",(0,i.jsx)(n.h3,{id:"--mode-ram-authenticator-token",children:"--mode ram-authenticator-token"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'$ ack-ram-tool credential-plugin get-kubeconfig --mode ram-authenticator-token --cluster-id c5e***\n\nkind: Config\napiVersion: v1\nclusters:\n    - name: kubernetes\n      cluster:\n        server: https://106.*.*.*:6443\n        certificate-authority-data: LS0t***\ncontexts:\n    - name: 272***-c5e***\n      context:\n        cluster: kubernetes\n        user: "272***"\ncurrent-context: 272***-c5e***\nusers:\n    - name: "272***"\n      user:\n        exec:\n            command: ack-ram-tool\n            args:\n                - credential-plugin\n                - get-token\n                - --cluster-id\n                - c5e***\n                - --api-version\n                - v1beta1\n                - --log-level\n                - error\n            apiVersion: client.authentication.k8s.io/v1beta1\n            provideClusterInfo: false\n            interactiveMode: Never\npreferences: {}\n\n'})}),"\n",(0,i.jsx)(n.h2,{id:"flags",children:"Flags"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Usage:\n  ack-ram-tool credential-plugin get-kubeconfig [flags]\n\nFlags:\n      --api-version string            v1 or v1beta1 (default "v1beta1")\n  -c, --cluster-id string             The cluster id to use\n      --credential-cache-dir string   Directory to cache certificate (default "~/.kube/cache/ack-ram-tool/credential-plugin")\n      --expiration duration           The certificate expiration (default 3h0m0s)\n  -h, --help                          help for get-kubeconfig\n  -m, --mode string                   credential mode: certificate or ram-authenticator-token (default "certificate")\n      --private-address               Use private ip as api-server address\n      --role-arn string               Assume an RAM Role ARN when send request or sign token\n\nGlobal Flags:\n  -y, --assume-yes                      Automatic yes to prompts; assume "yes" as answer to all prompts and run non-interactively\n      --ignore-aliyun-cli-credentials   don\'t try to parse credentials from config.json of aliyun cli\n      --ignore-env-credentials          don\'t try to parse credentials from environment variables\n      --log-level string                log level: info, debug, error (default "info")\n      --profile-file string             Path to credential file (default: ~/.aliyun/config.json or ~/.alibabacloud/credentials)\n      --profile-name string             using this named profile when parse credentials from config.json of aliyun cli\n      --region-id string                The region to use (default "cn-hangzhou")\n'})}),"\n",(0,i.jsx)(n.p,{children:"Descriptions\uff1a"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Flag"}),(0,i.jsx)(n.th,{children:"Default"}),(0,i.jsx)(n.th,{children:"Required"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"-c, --cluster-id"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"Cluster ID"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"-m, --mode"}),(0,i.jsx)(n.td,{children:"certificate"}),(0,i.jsx)(n.td,{}),(0,i.jsxs)(n.td,{children:["Authentication methods in kubeconfig: ",(0,i.jsx)(n.code,{children:"certificate"})," indicates certificate authentication, and ",(0,i.jsx)(n.code,{children:"ram-authenticator-token"})," indicates token authentication based on ack-ram-authenticator"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"--expiration"}),(0,i.jsx)(n.td,{children:"3h"}),(0,i.jsx)(n.td,{}),(0,i.jsxs)(n.td,{children:["When --mode is set to ",(0,i.jsx)(n.code,{children:"certificate"}),", set the certificate expiration time through this parameter. When it is 0, it means not to use a temporary certificate but to use a longer valid certificate (the expiration time is automatically determined by the server)."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"--private-address"}),(0,i.jsx)(n.td,{children:"false"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:"Whether to use the intranet API server address?"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"--api-version"}),(0,i.jsx)(n.td,{children:"v1beta1"}),(0,i.jsx)(n.td,{}),(0,i.jsxs)(n.td,{children:["Specify which version of apiVersion to use in the returned data. ",(0,i.jsx)(n.code,{children:"v1beta1"})," represents ",(0,i.jsx)(n.code,{children:"client.authentication.k8s.io/v1beta1"}),", and ",(0,i.jsx)(n.code,{children:"v1"})," represents ",(0,i.jsx)(n.code,{children:"client.authentication.k8s.io/v1"}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"--credential-cache-dir"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"~/.kube/cache/ack-ram-tool/credential-plugin"})}),(0,i.jsx)(n.td,{}),(0,i.jsxs)(n.td,{children:["The directory used to cache the certificate is only valid when ",(0,i.jsx)(n.code,{children:"--mode"})," is set to ",(0,i.jsx)(n.code,{children:"certificate"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"--role-arn"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:"Assume an RAM Role ARN when send request or sign token"})]})]})]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);